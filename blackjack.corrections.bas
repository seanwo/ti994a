1 CALL CLEAR :: GOTO 6000
100 REM BLACK JACK / (C) 1987
110 REM BY SEAN WOHLGEMUTH
120 CALL CLEAR
130 REM ***INITIALIZE***
140 REM HEART, DIAMOND, SPADE, CLUB
150 CALL CHAR (40, "00367F7F7F3E1C08" )
160 CALL CHAR (41, "00081C3E7F3E1C08" )
170 CALL CHAR (96, "0010387CFEFED638" )
180 CALL CHAR (97, "00103854EE541038" )
185 REM REMAP 42-54 AND 112-124
190 LET A=42
200 FOR I=1 TO 2
205 REM 2-10, JACK, KING QUEEN, ACE
210 CALL CHAR (A, "003844040830407C")
220 CALL CHAR (A+1, "0038040418040438")
230 CALL CHAR (A+2, "002424243C040404")
240 CALL CHAR (A+3, "003C20203C04043C")
250 CALL CHAR (A+4, "001C202038242418")
260 CALL CHAR (A+5, "003C040408081010")
270 CALL CHAR (A+6, "003C24243C24243C")
280 CALL CHAR (A+7, "001C24241C040404")
290 CALL CHAR (A+8, "004C52525252524C")
300 CALL CHAR (A+9, "003E080808084830")
310 CALL CHAR (A+10, "0018242424241C02")
320 CALL CHAR (A+11, "0024242830282424")
330 CALL CHAR (A+12, "001824243C242424")
340 LET A=112 
350 NEXT I
365 REM TEXTURES
370 CALL CHAR (55, "AA55AA55AA55AA55")
380 CALL CHAR (104, "8080808080808080")
390 CALL CHAR (105, "00000000000000FF")
400 CALL CHAR (95, "FFFFFFFFFFFFFFFF")
410 REM COLOR SCHEME
430 CALL COLOR (1,3,3)
440 CALL COLOR (2,7,10)
450 CALL COLOR (3,7,10)
460 CALL COLOR (4,2,10)
470 CALL COLOR (5,10,3)
480 CALL COLOR (6,10,3)
490 CALL COLOR (7,10,3)
500 CALL COLOR (8,10,3)
510 CALL COLOR (9,2,10)
520 CALL COLOR (10,2,1)
530 CALL COLOR (12,2,10)
540 CALL COLOR (9,2,10)
550 CALL SCREEN (3)
560 RANDOMIZE
570 LET P1C1=INT (RND*13)+2
580 LET P2C1=INT (RND*13)+2
590 LET P1S=INT (RND*4)+1
600 LET P2S=INT (RND*4)+1
610 IF P1C1>10 THEN LET NC=10 ELSE NC=P1C1
612 IF P1C1=14 THEN NC=11
615 LET P1SUM=P1SUM+NC
620 IF P2C1>10 THEN LET NK=10 ELSE NK=P2C1
625 IF P2C1=14 THEN NK=11
626 LET P2SUM=P2SUM+NK
630 LET FILL=95
640 LET ROW=0
650 LET COL=0
655 LET S=P1C1
660 REM ***PRINT CARDS***
670 DISPLAY AT (1, 10): "BLACK JACK"
680 FOR I=1 TO 5
690 CALL VCHAR (4+ROW, 1+COL+I, FILL, 7)
700 NEXT I
710 CALL HCHAR (3+ROW, 2+COL, 105, 5)
720 CALL VCHAR (4+ROW, 7+COL, 104, 7)
730 IF P=1 THEN 1500
735 IF P=2 THEN 2000
830 IF P1S<3 THEN LET O=S+40
840 IF P1S>2 THEN LET O=S+110
900 CALL HCHAR (4+ROW, 2+COL, O, 1)
910 CALL HCHAR (10+ROW, 6+COL, O, 1)
920 IF P1S=1 THEN SUIT=40
930 IF P1S=2 THEN SUIT=41
940 IF P1S=3 THEN SUIT=96
950 IF P1S=4 THEN SUIT=97
960 REM --NUMBER 2--
965 IF S<>2 THEN 990
970 CALL HCHAR (6+ROW,4+COL,SUIT,1)
980 CALL HCHAR (8+ROW,4+COL,SUIT,1)
985 GOTO 1500
990 REM --NUMBER 3--
995 IF S<>3 THEN 1010
1000 CALL VCHAR (6+ROW,4+COL,SUIT,3)
1005 GOTO 1500
1010 REM --NUMBER 4--
1015 IF S>5 THEN 1090
1030 CALL HCHAR (6+ROW,3+COL,SUIT,1)
1040 CALL HCHAR (8+ROW,3+COL,SUIT,1)
1050 CALL HCHAR (6+ROW,5+COL,SUIT,1)
1060 CALL HCHAR (8+ROW,5+COL,SUIT,1)
1070 REM --NUMBER 5--
1075 IF S<>5 THEN 1500
1080 CALL HCHAR (7+ROW,4+COL,SUIT,1)
1085 GOTO 1500
1090 REM --NUMBER 6--
1095 IF S>7 THEN 1140
1100 CALL vCHAR (6+ROW,3+COL,SUIT,3)
1110 CALL vCHAR (6+ROW,5+COL,SUIT,3)
1120 REM --NUMBER 7--
1125 IF S<>7 THEN 1500
1130 CALL VCHAR (7+ROW,4+COL,SUIT,1) 
1135 GOTO 1500
1140 REM --NUMBER 8--
1145 IF S<>8 THEN 1230
1150 CALL HCHAR (5+ROW,3+COL,SUIT,1)
1160 CALL HCHAR (5+ROW,5+COL,SUIT,1)
1170 CALL HCHAR (6+ROW,4+COL,SUIT,1)
1180 CALL HCHAR (7+ROW,3+COL,SUIT,1)
1190 CALL HCHAR (7+ROW,5+COL,SUIT,1)
1200 CALL HCHAR (8+ROW,4+COL,SUIT,1)
1210 CALL HCHAR (9+ROW,3+COL,SUIT,1)
1220 CALL HCHAR (9+ROW,5+COL,SUIT,1)
1225 GOTO 1500
1230 REM --NUMBER 9--
1235 IF S<>9 THEN 1290
1240 CALL VCHAR (5+ROW,3+COL,SUIT,2)
1250 CALL VCHAR (5+ROW,5+COL,SUIT,2)
1260 CALL VCHAR (8+ROW,3+COL,SUIT,2)
1270 CALL VCHAR (8+ROW,5+COL,SUIT,2)
1280 CALL HCHAR (7+ROW,4+COL,SUIT,1)
1285 GOTO 1500
1290 REM --NUMBER 10--
1295 IF S<>10 THEN 1320
1300 CALL VCHAR (5+ROW,3+COL,SUIT,5)
1310 CALL VCHAR (5+ROW,5+COL,SUIT,5)
1315 GOTO 1500
1320 REM --JACK--
1325 IF S<>11 THEN 1370
1330 CALL VCHAR (5+ROW,5+COL,SUIT,5)
1340 CALL HCHAR (9+ROW,3+COL,SUIT,2)
1350 CALL HCHAR (8+ROW,3+COL,SUIT,1)
1360 GOTO 1500
1370 REM --QUEEN--
1375 IF S<>12 THEN 1410
1380 CALL VCHAR (5+ROW,3+COL,SUIT,5)
1390 CALL VCHAR (5+ROW,5+COL,SUIT,5)
1400 CALL HCHAR (5+ROW,4+COL,SUIT,1)
1401 CALL HCHAR (9+ROW,4+COL,SUIT,1)
1405 GOTO 1500
1410 REM --KING--
1415 IF S>13 THEN 1440
1420 CALL VCHAR (5+ROW,3+COL,SUIT,5)
1425 CALL VCHAR (5+ROW,5+COL,SUIT,2)
1426 CALL VCHAR (8+ROW,5+COL,SUIT,2)
1430 CALL VCHAR (7+ROW,4+COL,SUIT,1)
1435 GOTO 1500
1440 REM --ACE--
1445 CALL HCHAR (7+ROW,4+COL,SUIT,1)
1500 REM GO BACK TO CARD REVEAL?
1502 IF P=3 THEN 3000
1503 REM COMMON CARDS?
1505 IF Z=0 THEN 1530
1510 IF Z=1 THEN 1540
1520 IF Z=2 THEN 1550
1525 IF Z=3 THEN 1610
1530 LET FILL=55 :: ROW=10 :: COL=0 :: P=1 ::Z=1
1535 GOTO 660
1540 LET FILL=95 :: ROW=0 :: COL=6 :: P=0 :: Z=2
1541 LET P1C2=INT (RND*13)+2 
1542 LET P1S=INT (RND*4)+1
1543 IF P1C2>10 THEN NK=10 ELSE NK=P1C2
1544 IF P1C2=14 THEN NK=11
1545 LET P1SUM=P1SUM+NK
1546 S=P1C2
1547 GOTO 660
1550 LET FILL=55 :: ROW=10 :: COL=6 :: P=1 :: Z=3
1560 LET P2C2=INT (RND*13)+2 
1570 LET P2S=INT (RND*4)+1
1580 IF P2C2>10 THEN NK=10 ELSE NK=P2C2
1590 IF P2C2=14 THEN NK=11
1595 LET P2SUM=P2SUM+NK
1597 GOTO 660
1610 REM OPTIONAL CARDS
1620 IF BUSTED=1 THEN GOTO 1720
1625 DISPLAY AT (22,3): "DO YOU WANT ANOTHER CARD"
1626 ACCEPT AT (23,14) VALIDATE ("YN") BEEP SIZE (1) : A$
1628 DISPLAY AT (22,1) : "                      "
1629 IF A$="N" THEN 1990
1631 LET X=INT (RND*13)+2 
1632 LET P1S=INT (RND*4)+1
1633 IF X>10 THEN NC=10 ELSE NC=X
1634 IF X=14 THEN NC=11
1635 LET P1SUM=P1SUM+NK
1640 IF P1C3=0 THEN LET P1C3=X :: GOTO 1690
1650 IF P1C4=0 THEN LET P1C4=X :: GOTO 1690
1660 IF P1C5=0 THEN LET P1C5=X :: GOTO 1690
1690 LET COL=COL+6 :: ROW=0 :: FILL=95 :: P=0
1695 IF P1SUM>21 THEN BUSTED=1
1696 S=X
1700 GOTO 660
1720 REM ***PLAY AGAIN***
1725 DISPLAY AT (11,2) BEEP: "YOUR HAND IS OVER TWENTY" :: DISPLAY AT (22,1) BEEP: "DO YOU WISH TO PLAY AGAIN?"
1730 ACCEPT AT (23,13) SIZE(1) VALIDATE("NY") : A$
1740 IF A$="N" THEN 1780
1760 CALL CHARSET
1762 COL=0 :: ROW=0 :: FILL=0
1763 P1C1=0 :: P1C2=0 :: P1C3=0 :: P1C4=0 :: P1C5=0 :: P1S1=0 :: P1SUM=0
1764 P2C1=0 :: P2C2=0 :: P2C3=0 :: P2C4=0 :: P2C5=0 :: P2S2=0 :: P2SUM=0
1765 S=0  :: P=0 :: REVEAL=0 :: SUIT=0 :: BUSTED=0 :: Z=0
1766 NC=0 :: NK=0 :: SUM=0 :: COUNT=0
1770 GOTO 100
1780 REM ***SHUTDOWN***
1785 CALL CLEAR :: FOR I=1 TO 5 :: CALL CLEAR :: DISPLAY AT (12,7) BEEP: "GAME TERMINATED" :: FOR J=1 TO 100 :: NEXT J :: NEXT I
1790 FOR I=1 TO 1000 :: NEXT I :: END
3000 REM ***REVEAL CARDS***
3002 IF REVEAL=1 THEN 3040
3005 IF REVEAL=2 THEN 3060
3006 IF REVEAL=3 THEN 3090
3007 IF REVEAL=4 THEN 3120
3008 IF REVEAL=5 THEN 3500
3010 S=P2C1 :: P=3 :: ROW=10 :: COL=0 :: REVEAL=1 :: FILL=95
3020 GOTO 660
3040 S=P2C2 :: P=3 :: ROW=10 :: COL=6 :: REVEAL=2 :: FILL=95
3050 GOTO 660
3060 IF P2C3=0 THEN 3500
3070 S=P2C3 :: P=3 :: ROW=10 :: COL=12 :: REVEAL=3 :: FILL=95
3080 GOTO 660
3090 IF P2C4=0 THEN 3500
2100 S=P2C4 :: P=3 :: ROW=10 :: COL=18 :: REVEAL=4 :: FILL=95
3100 GOTO 660
3120 IF P1C5=0 THEN 3500
3121 S=P2C5 :: P=3 :: ROW=10 :: COL=24 :: REVEAL=5 :: FILL=95
3130 GOTO 660
3500 IF P2SUM>21 THEN 3700
3501 IF SUM>P2SUM THEN 3700
3510 IF P2SUM>SUM THEN 3600
3520 DISPLAY AT (12,7): "THIS GAME IS TIED"
3530 DISPLAY AT (22,1) BEEP: "DO YOU WISH TO PLAY AGAIN?"
3540 ACCEPT AT (23,14) SIZE (1) BEEP VALIDATE ("YN") : A$
3550 IF A$="Y" THEN 3800
3560 GOTO 1780
3600 DISPLAY AT (11,8): "I HAVE THE BETTER HAND!!"
3610 GOTO 1780
3700 DISPLAY AT (11,6): "YOU HAVE THE BETTER HAND!!"
3710 GOTO 3530
3800 REVEAL=0 :: P2C1=0 :: P2C2=0 :: P2C3=0 :: P2C4=0 :: P2C5=0 :: P=0 :: BAYER=0 :: P2SUM=0 :: M=0
3810 GOTO 1760
6000 REM ***INTRODUCTION***
6010 DISPLAY AT (12,10): "BLACK JACK"
6090 DISPLAY AT (13,1): "presented by Sean Wohlgemuth"
6100 FOR I=1 TO 500 :: NEXT I :: CALL CLEAR
6104 PRINT "RULES:"
6115 PRINT
6120 PRINT "THIS IS A GAME BETWEEN YOU AND THE DEALER (COMPUTER)"
6130 PRINT
6140 PRINT "OBJECT OF GAME:"
6150 PRINT
6160 PRINT "THE OBJECT OF THIS GAME IS TO COLLECT A SET OF CARDS THAT IS LESS THAN OR EQUAL TO"
6170 PRINT "21. IF YOUR SET OF CARDS IS HIGHER THAN THE DEALER'S AND NOT OVER 21 THEN YOU WIN"
6180 PRINT
6190 PRINT "VALUES:"
6200 PRINT 
6205 PRINT "NUMBER CARDS = FACE VALUE"
6210 PRINT "FACE CARDS = 10 POINTS"
6220 PRINT "ACES = 11 OR 1 POINT(S)"
6230 PRINT "(IF THE VALUE OF AN ACE IS OVER 21; THEN IT'S VALUE IS 1.)"
6240 PRINT
6245 INPUT "PRESS ENTER TO CONTINUE:":A$
6250 CALL CLEAR
6260 PRINT "HOW TO PLAY:"
6270 PRINT
6280 PRINT "BOTH YOU AND THE DEALER WILL BE GIVEN TWO CARDS TO START. THEN TAKE AS MANY CARDS AS YOU WISH IF YOUR HAND IS"
6290 PRINT "OVER 21 YOU LOSE."
6300 FOR I=1 TO 15 :: PRINT :: NEXT I
6310 INPUT "PRESS ENTER TO BEGIN:":A$
7000 CALL CLEAR :: GOTO 150