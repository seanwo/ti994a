100 REM ELECTRIC BATTLESHIP
110 REM (C)1987-1988
120 REM BY Sean Wohlgemuth
130 REM ////////////////////////////////////
140 DIM P(18):: DIM P$(18):: DIM Z(18):: DIM Z$(18):: DIM B(5):: DIM B$(5)
150 DIM TEMP(5):: DIM T1(17):: DIM T1$(17):: DIM SW$(10):: DIM SX$(10)
160 ON WARNING NEXT
170 RANDOMIZE
180 REM GRAPHICS
190 REM ////////////////////////////////////
200 CALL CLEAR
210 CALL SCREEN(16)
220 CALL CHAR(96,"3C4299A5A599423C")
230 CALL CHAR(104,"003C7E7E7E7E3C00")
240 CALL CHAR(58,"004FC949494949EF")
250 CALL CLEAR
260 CALL COLOR(12,8,8)
270 FOR I=1 TO 20
280 CALL HCHAR(1+I,2,127,20)
290 NEXT I
300 FOR I=1 TO 10
310 CALL HCHAR(2+I,23,127,10)
320 NEXT I
330 CALL COLOR(9,2,8)
340 FOR I=1 TO 20 STEP 2
350 FOR T=1 TO 20 STEP 2
360 CALL HCHAR(I+2,1+T,92,1)
370 NEXT T
380 NEXT I
390 FOR I=1 TO 9
400 LET L=L+2
410 CALL HCHAR(1,L,48+I,1)
420 NEXT I
430 CALL HCHAR(1,20,58,1)
440 LET L=0
450 FOR I=1 TO 10
460 LET L=L+2
470 CALL HCHAR(1+L,22,64+I,1)
480 NEXT I
490 FOR I=1 TO 10
500 CALL HCHAR(2+I,23,96,10)
510 NEXT I
520 DISPLAY AT (14,23):" INPUT"
530 DISPLAY AT (15,22);"LOCATION"
540 DISPLAY AT (16,25):"OF"
550 CALL HCHAR(15,31,78,1):: T=0
560 LET T$="BATTLE" :: S=4
570 SUM=0 :: DISPLAY AT(17,23):T$
580 IF T$<>"BATTLE" THEN 600
590 DISPLAY AT (18,24):"SHIP"
600 FOR I=1 TO S
610 DISPLAY AT(19+S+1,21):""
615 DISPLAY AT(19+S+2,21):""
620 DISPLAY AT(19+S+2,21):I
630 NEXT I
640 DISPLAY AT(19,23):"LET/#"
630 NEXT I
650 REM
660 FOR I=1 TO S
670 ACCEPT AT(19+I,23)VALIDATE("ABCDEFGHIJ")SIZE(1):B$(I)
680 IF B$(I)="" THEN 670
690 ACCEPT AT(19+I,23)VALIDATE(DIGIT)SIZE(2):B(I)
700 NEXT I
710 FOR L=2 TO S STEP 1
720 IF B$(L-1)<>B$(L) THEN 1280
730 NEXT L
740 MARC=200
750 FOR I=1 TO S
760 IF B(I)<MARC THEN MARC=B(I)
770 NEXT I
780 IF MARC>10-S THEN 570
790 LET TOTAL =MARC
800 FOR I=1 TO S-1
810 LET TOTAL=TOTAL+(MARC+I)
820 NEXT I
830 FOR I=1 TO S
840 LET SUM=SUM +B(I)
850 NEXT I
860 IF SUM<>TOTAL THEN 570
870 IF TRICK=1 THEN 1490
880 LET T=T+1
890 IF T=1 THEN SR=1
900 IF T=2 THEN SR=5
910 IF T=3 THEN SR=8
920 IF T=4 THEN SR=11
930 IF T=5 THEN SR=16
940 F=0
950 FOR K=SR TO SR+S-1
960 LET F=F+1
970 P(K)=B(F):: P$(K)=B$(F)
980 NEXT K
990 FOR I=SR TO SR+S-1
1000 IF T<>1 THEN 1030
1010 Z(I)=P(I)
1020 Z$(I)=P$(I)
1030 IF T<>2 THEN 1060
1040 Z(I)=P(I)
1050 Z$(I)=P$(I)
1060 IF T<>3 THEN 1090
1070 Z(I)=P(I)
1080 Z$(I)=P$(I)
1090 IF T<>4 THEN 1120
1100 Z(I)=P(I)
1110 Z$(I)=P$(I)
1120 IF T<>5 THEN 1150
1130 Z(I)=P(I)
1140 Z$(I)=P$(I)
1150 IF I=17 THEN 1540
1160 NEXT I
1170 IF T=1 THEN S=3
1180 IF T=2 THEN S=3
1190 IF T=3 THEN S=5
1200 IF T=4 THEN S=2
1210 IF S=3 THEN T$="FLAG 1"
1220 IF T=2 THEN T$="FLAG 2"
1230 IF S=5 THEN T$="DESTR."
1240 IF S=2 THEN T$="CRUISE"
1250 IF S=2 THEN DISPLAY AT(24,21):""
1260 LET SUM=0
1270 GOTO 570
1280 LET L=0
1290 FOR L=2 TO S STEP 1
1300 IF B(L-1)<>B(L) THEN 570
1310 NEXT L
1320 TRICK=1
1330 FOR I=1 TO S
1340 LET TEMP(I)=B(I)
1350 NEXT I
1360 FOR I=1 TO S
1370 IF B$(I)="A" THEN B(I)=1
1380 IF B$(I)="B" THEN B(I)=2
1390 IF B$(I)="C" THEN B(1)=3
1400 IF B$(I)="D" THEN B(I)=4
1410 IF B$(I)="E" THEN B(I)=5
1420 IF B$(I)="F" THEN B(I)=6
1430 IF B$(I)="G" THEN B(I)=7
1440 IF B$(I)="H" THEN B(I)=8
1450 IF B$(I)="I" THEN B(I)=9
1460 IF B$(I)="J" THEN B(I)=10
1470 NEXT I
1480 GOTO 740
1490 TRICK=0
1500 FOR I=1 TO S
1510 LET B(I)=TEMP(I)
1520 NEXT I
1530 GOTO 880
1540 FOR I=1 TO 17
1150 LET P(I)=Z(I):: P$(I)=Z$(I)
1560 NEXT I
1570 FOR I=1 TO 17
1580 FOR T=1 TO 17
1590 IF I=T THEN 1610
1600 IF P(I)=P(T) THEN 1650
1610 NEXT T
1620 NEXT I
1630 IF LIFE=1 THEN GOTO 2370
1640 GOTO 1680
1650 IF LIFE=1 THEN GOTO 2340
1660 IF P$(I)=P$(T) THEN 520
1670 GOTO 1610
1680 FOR I=1 TO 8
1690 CALL HCHAR(15,31,32,1)
1700 DISPLAY AT (13+I,21):""
1710 NEXT I
1720 DISPLAY AT(14,23):"PLAYER"
1730 DISPLAY AT(15,23):"LOCKED"
1740 DISPLAY AT(16,25)BEEP:"IN"
1750 CALL CHAR(112,"3C4299A5A599423C")
1760 CALL COLOR(11,2,3)
1770 FOR I=1 TO 17
1780 FOR T=1 TO 10
1790 IF P$(I)=CHR$(64+T) THEN W=T
1800 NEXT T
1810 CALL HCHAR(2+W,22+P(I),112,1)
1820 NEXT I
1830 LET S=4 :: SA=1
1840 SIC=INT(RND*2)+1
1850 POST =INT(RND*(10-S)+1
1860 IF SIC=2 THEN 2090
1870 X=0 :: TRICK=0
1880 FOR I=SA TO S+SA-1
1890 LET X=X+1
1900 P(I)=POST-1+X
1910 NEXT I
1920 POST =INT(RND*10)+1
1930 IF POST=1 THEN W$="A"
1940 IF POST=2 THEN W$="B"
1950 IF POST=3 THEN W$="C"
1960 IF POST=4 THEN W$="D"
1970 IF POST=5 THEN W$="E"
1980 IF POST=6 THEN W$="F"
1990 IF POST=7 THEN W$="G"
2000 IF POST=8 THEN W$="H"
2010 IF POST=9 THEN W$="I"
2020 IF POST=10 THEN W$="J"
2030 IF TRICK=1 THEN 2140
2040 FOR I=SA TO S+SA-1
2050 P$(I)=W$
2060 NEXT I
2070 LIFE=1 :: GOTO 2220
2080 GOTO 2380
2090 GOT=0 :: POST=POST-1
2100 LET GOT=GOT+1
2110 LET POST=POST+1
2120 LET TRICK=1
2130 IF GOT=GOT THEN GOTO 1930
2140 FOR T=(SA-1)+GOT TO (SA-1)+GOT
2150 P$(T)=W$
2160 NEXT T
2170 IF GOT<>S THEN GOTO 2100
2180 POST=INT(RND*10)+1
2190 FOR I=SA TO S+SA-1
2200 LET P(I)=POST
2210 NEXT I
2220 IF SA=11 THEN SA=16
2230 IF S=2 THEN 2330
2240 IF SA=8 THEN SA=11
2250 IF SA=5 THEN SA=8
2260 IF SA=1 THEN SA=5
2270 IF SA=5 THEN S=3
2280 IF SA=8 THEN S=3
2290 IF SA=11 THEN S=5
2300 IF SA=16 THEN S=2
2310 IF LIFE=1 THEN GOTO 1840
2320 GOTO 1840
2330 LET LIFE=1 :: GOTO 1570
2340 IF P$(I)=P$(T) THEN 2360
2350 GOTO 1670
2360 LIFE=0 :: TRICK=0 :: GOTO 1830
2370 REM
2380 DISPLAY AT(18,21):"COMPUTER"
2390 DISPLAY AT(19,23):"LOCKED"
2400 DISPLAY AT(20,25)BEEP:"IN"
2410 FOR I=1 TO 500 ::NEXT I
2420 FOR I=1 TO 8 :: DISPLAY AT(13+I,21):""  ::NEXT I
2430 DISPLAY AT(14,23):"PLAYER"
2440 DISPLAY AT(15,23):"TARGET"
2450 DISPLAY AT(20,23):"ENEMY"
2460 DISPLAY AT(21,23):"TARGET"
2470 DISPLAY AT(16,22):"(LET/#)"
2480 DISPLAY AT(17,22):""
2490 ACCEPT AT (17,23)SIZE(1)VALIDATE("ABCDEFGHIJ"):PL$
2500 IF PL$="" THEN 2490
2510 ACCEPT AT(17,24)SIZE(2)VALIDATE(DIGIT):PL
2520 IF PL>10 THEN 2510
2530 IF PL<1 THEN 2510
2540 FOR H=1 TO 17
2550 IF PL=P(H) THEN GOTO 2580
2560 NEXT H
2570 GOTO 2810
2580 IF PL$<>P$(H) THEN GOTO 2560
2590 FOR I=1 TO 17
2600 IF PL<>T1(I) THEN 2620
2610 IF PL$=T1$(I) THEN 2470
2620 NEXT I
2630 XL=XL+1
2640 IF H>15 THEN R5=R5+1
2650 IF H>15 THEN 2730
2660 IF H>10 THEN R4=R4+1
2670 IF H>10 THEN 2730
2680 IF H>7 THEN R3=R3+1
2690 IF H>7 THEN 2730
2700 IF H>4 THEN R2=R2+1
2710 IF H>4 THEN 2730
2720 IF H>0 THEN R1=R1+1
2730 T1(XL)=PL :: T1$(XL)=PL$
2740 FOR H=1 TO 10
2750 IF PL$=CHR$(64+H) THEN V=H
2760 NEXT H
2770 DISPLAY AT(18,23)BEEP:"(HIT)"
2780 CALL CHAR(104,"3C4299A5A599423C" )
2790 CALL HCHAR(2*V+1,2*PL,104,1)
2800 GOTO 2900
2810 DISPLAY AT(18,23)BEEP:"(MISS)"
2820 REM
2830 CALL CHAR(128,"3C4299A5A599423C")
2840 CALL COLOR(13,2,16)
2850 FOR I=1 TO 17
2860 IF PL$=CHR$(64+I) THEN V=I
2870 NEXT I
2880 CALL HCHAR(2*V+1,2*PL,128,1)
2890 GOTO 3280
2900 CALL CHAR(136,"3C4299A5A599423C")
2910 CALL COLOR(14,2,9)
2920 IF W1=1 THEN 2960
2930 IF R1=4 THEN LET K=1
2940 IF R1=4 THEN W1=1
2950 IF R1=4 THEN 3130
2960 IF W2=1 THEN 3000
2970 IF R2=3 THEN LET K=5
2980 IF R2=3 THEN W2=1
2990 IF R2=3 THEN 3130
3000 IF W3=1 THEN 3040
3010 IF R3=3 THEN LET K=8
3020 IF R3=3 THEN W3=1
3030 IF R3=3 THEN 3130
3040 IF W4=1 THEN 3080
3050 IF R4=5 THEN LET K=11
3060 IF R4=5 THEN W4=1
3070 IF R4=5 THEN 3130
3080 IF W5=1 THEN 3120
3090 IF R5=2 THEN LET K=16
3100 IF R5=2 THEN W5=1
3110 IF R5=2 THEN 3130
3120 GOTO 3280
3130 IF K=1 THEN F3=4
3140 IF K=5 THEN F3=3
3150 IF K=8 THEN F3=3
3160 IF K=11 THEN F3=5
3170 IF K=16 THEN F3=2
3180 FOR I=K TO K+F3-1
3190 FOR H=1 TO 10
3200 IF P$(I)=CHR$(64+H) THEN V=H
3210 NEXT I
3220 CALL HCHAR(V*2+1,P(I)*2,136,1)
3230 NEXT I
3240 CALL SOUND(1000,-6,2)
3250 IF R1+R2+R3+R4+R5=17 THEN 3270
3260 GOTO 3280
3270 END
3280 IF SEC=1 THEN GOTO 3790
3290 IF SEC=2 THEN 4550
3300 IF SEC=3 THEN 4890
3310 IF NET=1 THEN 3380
3320 FOR I=1 TO 10 STEP 2
3330 SW$(I)="ACEGI"
3340 SX$(I)="BDFHJ"
3350 SW$(I+1)="BDFHJ"
3360 SX$(I+1)="ACEGI"
3370 NEXT I
3380 G=INT(RND*10)+1
3390 X=LEN(SW$(G))
3400 IF x=0 THEN 3380
3410 G1=INT(RND*X)+1
3420 G$=SEG$(SW$(G),G1,1)
3430 G2=ASC(G$)-64
3440 IF X=1 THEN GOTO 3480
3450 LET G4=G1-1::G5=G1+1
3460 LET SW$(G)=SEG$(SW$(G),1,G4)&SEG$(SW$(G),G5,6)
3470 GOTO 3490
3480 LET SW$(G)=SEG$(SW$(G),2,5)
3490 SHIP=1:: FOR I=1 TO 17
3500 IF G=Z(I) THEN 3530
3510 NEXT I
3520 GOTO 3510
3530 IF G$=Z$(I) THEN 3620
3540 GOTO 3510
3550 DISPLAY AT(22,23):G$
3560 DISPLAY AT(22,24):G
3570 CALL COLOR (13,2,16)::CALL CHAR(128,"3C4299A5A599423C")
3580 DISPLAY AT(23,23):"(MISS)"
3590 CALL HCHAR(2+G2,22+G,128,1)
3600 NET=1
3610 GOTO 2430
3620 IF I<5 THEN C=1
3630 IF I<5 THEN GOTO 3710
3640 IF I<8 THEN C=2
3650 IF I<8 THEN GOTO 3710
3660 IF I<11 THEN C=3
3670 IF I<11 THEN GOTO 3710
3680 IF I<16 THEN C=4
3690 IF I<16 THEN GOTO 3710
3700 C=5
3710 IF LIP=1 THEN 4230
3720 S=C
3730 DISPLAY AT(22,23):G$
3740 DISPLAY AT(22,24):G
3750 DISPLAY AT(23,23):"(HIT)"
3760 CALL COLOR(10,2,12)::CALL CHAR(104,"3C4299A5A599423C")
3770 CALL HCHAR(2+G2,22+G,104,1)
3780 LET SEC=1:: NET=1 ::GOTO 2430
3790 RAND=INT(RND*4)+1
3800 IF RAND=1 THEN T=0
3810 IF RAND=1 THEN T2=-1
3820 IF RAND=2 THEN T=1
3830 IF RAND=2 THEN T2=0
3840 IF RAND=3 THEN T=0
3850 IF RAND=3 THEN T2=1
3860 IF RAND=4 THEN T=-1
3870 IF RAND=4 THEN T2=0
3880 IF T+G<1 THEN GOTO 3790
3890 IF T+G>10 THEN GOTO 3790
3900 IF ASC(G$)-64+T2<1 THEN GOTO 3790
3910 IF ASC(G$)-64+T2>10 THEN GOTO 3790
3920 FOR I=1 TO 5
3930 IF NAF=1 THEN 3960
3940 IF CHR$(ASC(G$)+T2)=SEG$(SX$(G+T),I,1) THEN 3990
3950 GOTO 3970
3960 IF CHR$(ASC(G$)+T2)=SEG$(SW$(G+T),I,1) THEN 3990
3970 NEXT I
3980 GOTO 3790
3990 IF I=1 THEN GOTO 4050
4000 IF NAF=1 THEN 4030
4010 LET SX$(G+T)=SEG$(SX$(G+T),1,I-1)&SEG$(SX$(G+T),I+1,4)
4020 GOTO 4040
4030 LET SW$(G+T)=SEG$(SW$(G+T),1,I-1)&SEG$(SW$(G+T),I+1,4)
4040 GOTO 4090
4050 IF NAF=1 THEN 4080
4060 LET SX$(G+T)=SEG$(SX$(G+T),2,5)
4070 GOTO 4090
4080 LET SW$(G+T)=SEG$(SW$(G+T),2,5)
4090 FOR I=1 TO 17
4100 IF G+T=Z(I) THEN 4130
4110 NEXT I
4120 GOTO 4150
4130 IF CHR$(ASC(G$)+T2)=Z$(I) THEN 4200
4140 GOTO 4110
4150 DISPLAY AT(22,23):CHR$(ASC(G$)+T2);G+T::DISPLAY AT(22,23):"(MISS)"
4160 CALL HCHAR(2+ASC(G$)+T2-64,22+G+T,128,1)
4170 IF LIVE=1 THEN 4190
4180 SEC=1
4190 GOTO 2420
4200 REM
4210 LIP=1
4220 GOTO 3620
4230 LIP=0
4240 IF NAF=1 THEN VV=0 ELSE VV=1
4250 IF S=C THEN 4390
4260 IF V1<>0 THEN 4390
4270 V1$=CHR$(ASC(G$)+T2)
2280 V1=G+T:: VV1=VV
2290 GOTO 4380
4300 IF V2<>0 THEN 4330 ELSE V2=G+T
4310 V2$=CHR$(ASC(G$)+T2) ::VV2=VV
4320 GOTO 4380
4330 IF V3<>0 THEN GOTO 4370
4340 V3=G+T ::VV3=VV
4350 V3$=CHR$(ASC(G$)+T2)
4360 GOTO 4380
4370 VV4=VV :: V4=G+T:: V4$=CHR$(ASC(G$)+T2)
4380 SEC=1 :: GOTO 4420
4390 SHIP=SHIP+1
4400 REM
4410 SEC=2 ::GOTO 4420
4420 DISPLAY AT(22,23):CHR$(ASC(G$)+T2);G+T
4430 CALL HCHAR(2+ASC(G$)+T2-64,22+G+T,104,1)
4440 DISPLAY AT(23,23):"(HIT)"
4450 IF SHIP<>2 THEN 4470
4460 IF S=5 THEN 5000
4470 IF SHIP<>3 THEN 4500
4480 IF S=2 THEN 5000
4490 IF S=3 THEN 5000
4500 IF SHIP<>4 THEN 4520
4510 IF S=1 THEN 5000
4520 IF SHIP<>5 THEN 4540
4530 IF S=4 THEN 5000
4540 GOTO 2480
4550 IF RAND=1 THEN T2=T2-1
4560 IF RAND=2 THEN T=T+1
4570 IF RAND=3 THEN T2=T2+1
4580 IF RAND=4 THEN T=T-1
4590 IF ASC(G$)-64+T2>10 THEN GOTO 4890
4600 IF ASC(G$)-64+T2<1 THEN GOTO 4890
4610 IF G+T>10 THEN GOTO 4890
4620 IF G+T<1 THEN GOTO 4890
4630 FOR I=1 TO 5
4640 IF NAF=1 THEN 4670
4650 IF CHR$(ASC(G$)+T2)=SEG$(SW$(T+G),I,1) THEN GOTO 4700
4660 GOTO 4680
4670 IF CHR$(ASC(G$)+T2)=SEG$(SX$(T+G),I,1) THEN GOTO 4700
4680 NEXT I
4690 GOTO 4890
4700 IF I=1 THEN 4760
4710 IF NAF=1 THEN GOTO 4740
4720 LET SW$(T+G)=SEG$(SW$(T+G),1,I-1)&SEG$(SW$(T+G),I+1,3)::NAF=1
4730 GOTO 4750
4740 LET SX$(T+G)=SEG$(SX$(T+G),1,I-1)&SEG$(SX$(T+G),1+1,3)::NAF=0
4750 GOTO 4800
4760 IF NAF=1 THEN 4790
4770 LET SW$(T+G)=SEG$(SW$(T+G),2,5)::NAF=1
4780 GOTO 4800
4790 LET SX$(T+G)=SEG$(SX$(T+G),2,5)::NAF=0
4800 IF NEF=1 THEN 4870
4810 FOR I=1 TO 17
4820 IF Z(I)=G+T THEN 4850
4830 NEXT I
4840 SEC=3 :: LIVE=1 ::GOTO 4150
4850 IF Z$(I)=CHR$(ASC(G$)+T2) THEN 4830
4860 GOTO 4830
4870 SHIP=SHIP+1
4880 GOTO 4420
4890 IF RAND<>1 THEN 4910
4900 RAND=3 :: GOTO 4960
4910 IF RAND<>3 THEN 4930
4920 RAND=1 :: GOTO 4960
4930 IF RAND<>4 THEN 4950
4940 RAND=2 :: GOTO 4960
4950 RAND=4
4960 IF FIN=1 THEN NAF=0 ELSE NAF=1
4970 FIN=0
4980 T=0:: T2=0:: SEC=2
4990 GOTO 4550
5000 IF S=1 THEN RE=4
5010 IF S=1 THEN K=1
5020 IF S=2 THEN RE=7
5030 IF S=2 THEN K=5
5040 IF S=3 THEN RE=10
5050 IF S=3 THEN K=8
5060 IF S=4 THEN RE=15
5070 IF S=4 THEN K=11
5080 IF S=5 THEN RE=17
5090 IF S=5 THEN K=16
5100 CALL CHAR (136,"3C4299A5A599423C")
5110 CALL COLOR(14,2,9)
5120 FOR I=K TO RE
5130 CALL HCHAR(2+ASC(Z$(I))-64,22+Z(I),136,1)
5140 NEXT I
5150 IF V1=0 THEN 5190
5160 NAF=VV1
5170 G=V1::G$=V1$ ::SEC=1:: SHIP=1 ::V1=0
5180 GOTO 5270
5190 IF V2=0 THEN 5230
5200 NAF=VV2
5210 SHIP=1 :: G=V2 ::G$=V2$::SEC=1 ::V2=0
5220 GOTO 5270
5230 IF V3=0 THEN 5420
5240 NAF=VV3
5250 SHIP=1:: G=V3::G$=V3$:: SEC=1 ::V3=0
5260 GOTO 5270
5270 FOR I=1 TO 17
5280 IF Z$(I)=G$ THEN 5310
5290 NEXT I
5300 END
5310 IF Z(I)=G THEN 5330
5320 GOTO 5290
5330 IF I>16 THEN 5350 ELSE C=5
5340 GOTO 5400
5350 IF I<11 THEN 5370 ELSE C=4
5360 GOTO 5400
5370 IF I<8 THEN 5390 ELSE C=3
5380 GOTO 5400
5390 IF I<5 THEN C=1 ELSE C=2
5400 FIN=NAF::S=C::GOTO 2480
5410 S=C::GOTO 2480
5420 NEF=0 ::NAF=0 ::LET SEC=0 :: GOTO 2480